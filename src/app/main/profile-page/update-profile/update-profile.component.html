<div class="container">
    <div class="row">
        <div class="col-3"></div>
        <div class="col-6">
            <div class="loading" *ngIf="loadingProfile">loading...</div>

            <div class="alert alert-danger" role="alert"
            *ngIf="!generalDataChanged && generalDataFormSubmitted">
            Errore nella modifica dei dati!
            </div>

            <div class="alert alert-success" role="alert" *ngIf="generalDataChanged && generalDataFormSubmitted">
                Dati cambiati con successo
            </div>

            <form *ngIf="!loadingProfile" enctype="multipart/form-data" (ngSubmit)="onChangeGeneralData()" #f="ngForm">
                <h3>Nickname:</h3>
                <input 
                        type="text"
                        class="form-control"
                        name="nickname"
                        [(ngModel)]="profile.nickname"
                        required
                        minlength="4">
                <h3>Nome:</h3>
                <input 
                        type="text"
                        class="form-control"
                        name="nome"
                        [(ngModel)]="profile.nome"
                        required
                        minlength="4">
                <h3>Biografia:</h3>
                <input 
                        type="text" 
                        class="form-control"
                        name="biografia"
                        [(ngModel)]="profile.biografia"
                        required
                        minlength="4">
                <button 
                        type="submit"
                        class="btn btn-primary"
                        [disabled]="!f.valid">
                    modifica
                </button>
            </form>
        </div>
        <div class="col-3"></div>
    </div>

    <hr>
    <div class="row">
            <div class="col-3"></div>
            <div class="col-6">
                <div class="alert alert-danger" role="alert"
                *ngIf="!fileIsOkay && fileIsSended">
                Errore nel caricamento della foto!
                </div>
    
                <div class="alert alert-success" role="alert" 
                *ngIf="fileIsOkay && fileIsSended">
                    Foto caricata con successo!
                </div>
                <h3>Seleziona un'immagine del profilo: (formato png)</h3>
                <div class="custom-file mb-2">
                    <input 
                        type="file"
                        class="custom-file-input"
                        name="proPic"
                        id="customFile"
                        #fileInput
                        (change)="onFileChanged($event)"
                        required
                        >
                    <label 
                        class="custom-file-label"
                        for="customFile"
                        (click)="fileInput.click()">
                        <span *ngIf="!fileIsSelected">Scegli file</span>
                        <span *ngIf="fileIsSelected">{{fileName}}</span>
                </label>
                    <button 
                    class="btn btn-primary"
                    (click)="onUpload()">Carica la foto</button>

                </div>

            </div>
            <div class="col-3"></div>




    </div>

    <!-- 
        eventualmente, cambio email e password
    -->
    <hr>
    <div class="row">
        <div class="col-3"></div>
        <div class="col-6">
            <div class="alert alert-danger" role="alert"
                    *ngIf="emailChangeSubmitted &&
                    !emailChangeSuccess">
                    Errore nel cambio email, ricontrolla la password!
            </div>

            <div class="alert alert-success" role="alert" *ngIf="emailChangeSuccess">
                Email cambiata con successo
            </div>

            <form [formGroup]="emailForm" (ngSubmit)="onChangeMail()">
                <h3>email:</h3>
                <input 
                        type="text"
                        id="email"
                        formControlName="email"
                        class="form-control">
                <h3>password:</h3>
                <input
                        type="password"
                        id="password1"
                        formControlName="password"
                        class="form-control">
                <h3>confirm password:</h3>
                <input
                        type="password"
                        id="password-confirm1"
                        formControlName="confirm"
                        class="form-control">
                <button
                        type="submit"
                        class="btn btn-primary">
                        cambia mail
                </button>
            </form>
        </div>
        <div class="col-3"></div>
    </div>

    <hr>
    <div class="row">
        <div class="col-3"></div>
        <div class="col-6">

            <div class="alert alert-danger" role="alert"
            *ngIf="!passwordChangeSuccess && passwordChangeSubmitted">
            password sbagliata!
            </div>

            <div class="alert alert-success" role="alert"
                *ngIf="passwordChangeSuccess && passwordChangeSubmitted">
                Password modificata con successo.
            </div>

            
            <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()">
                <h3>vecchia password:</h3>
                <input 
                        type="password"
                        id="old"
                        formControlName="old"
                        class="form-control">
                <h3>nuova password:</h3>
                <input 
                        type="password"
                        id="new"
                        formControlName="new"
                        class="form-control">
                <h3>conferma password:</h3>
                <input 
                        type="password"
                        id="confirm"
                        formControlName="confirm"
                        class="form-control">
                <button 
                        
                        type="submit"
                        class="btn btn-primary">
                    cambia password
                </button>
            </form>
        </div>
        <div class="col-3"></div>
    </div>
</div>